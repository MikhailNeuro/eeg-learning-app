import BaseBlock from '../BaseBlock.js';
import { block4Data } from './data.js';

export default class Block4 extends BaseBlock {
    constructor(container, onBack) {
        super(container, onBack, block4Data);
    }

    mountInteractive(index) {
        const slideId = this.slides[index].id;
        this.stopAnimations(); // –ï—Å–ª–∏ –µ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏ –∏–∑ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞

        switch (slideId) {
            case 'medical': this.initGallery('med'); break;
            case 'market': this.initMarketSorter(); break;
            case 'consumer': this.initGallery('con'); break;
            case 'sales': this.initSalesSim(); break;
            case 'quiz': this.initQuiz(); break;
        }
    }

    // --- –ë–ê–ó–ê –î–ê–ù–ù–´–• –£–°–¢–†–û–ô–°–¢–í ---
    getDevices() {
        return {
            kompakt16: {
                id: 'kompakt16',
                name: '¬´–ö–æ–º–ø–∞–∫—Ç-–Ω–µ–π—Ä–æ¬ª (16 –∫–∞–Ω–∞–ª–æ–≤)',
                category: 'med',
                icon: 'img/kn16.png',
                short: '–ë—é–¥–∂–µ—Ç–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç',
                desc: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —ç–Ω—Ü–µ—Ñ–∞–ª–æ–≥—Ä–∞—Ñ –¥–ª—è —Ä—É—Ç–∏–Ω–Ω—ã—Ö –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π. –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π –∏ –±–∞–∑–æ–≤–æ–≥–æ —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤ –≠–≠–ì: 16',
                    '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: USB',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –≠–∫—Å–ø—Ä–µ—Å—Å-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –°–∫—Ä–∏–Ω–∏–Ω–≥',
                    '–≠–∫—Å–ø–æ—Ä—Ç: EDF, CSV, Loreta'
                ]
            },
            kompakt21: {
                id: 'kompakt21',
                name: '¬´–ö–æ–º–ø–∞–∫—Ç-–Ω–µ–π—Ä–æ¬ª (21 –∫–∞–Ω–∞–ª)',
                category: 'med',
                icon: 'img/kn21.png',
                short: '–†—É—Ç–∏–Ω–Ω–∞—è –≠–≠–ì',
                desc: '–°–∞–º–∞—è –ø–æ–ø—É–ª—è—Ä–Ω–∞—è –º–æ–¥–µ–ª—å. –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É ¬´10-20¬ª. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —ç–ø–∏–ª–µ–ø—Ç–∏—Ñ–æ—Ä–º–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤ –≠–≠–ì: 21 (–ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ 10-20)',
                    '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: USB',
                    '–≠–∫—Å–ø–æ—Ä—Ç: EDF, CSV, Loreta'
                ]
            },
            neuropoly: {
                id: 'neuropoly',
                name: '¬´–ù–µ–π—Ä–æ–ø–æ–ª–∏–≥—Ä–∞—Ñ¬ª (24 –∫–∞–Ω–∞–ª–∞)',
                category: 'med',
                icon: 'img/poly.png',
                short: '–£–≥–ª—É–±–ª–µ–Ω–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
                desc: '–≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –≤—ã—Å–æ–∫–æ–π —á–∞—Å—Ç–æ—Ç–æ–π –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã –¥–ª—è –ø–æ–ª–∏–≥—Ä–∞—Ñ–∏–∏.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤ –≠–≠–ì: 21',
                    '–ü–æ–ª–∏–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–∞–Ω–∞–ª—ã: 3 (–≠–ö–ì, –≠–ú–ì, –≠–û–ì)',
                    '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: USB',
                    '–≠–∫—Å–ø–æ—Ä—Ç: EDF, CSV, Loreta',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ù–∞—É–∫–∞, –°–ª–æ–∂–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'
                ]
            },
            neuroeeg: {
                id: 'neuroeeg',
                name: '¬´–ù–µ–π—Ä–æ–≠–≠–ì¬ª (–ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–π)',
                category: 'med',
                icon: 'img/neuroeeg.png',
                short: '–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –í–∏–¥–µ–æ-–≠–≠–ì',
                desc: '–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –Ω–æ—Å–∏–º—ã–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ç–æ—Ä. –ü–∞—Ü–∏–µ–Ω—Ç –º–æ–∂–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ –¥–≤–∏–≥–∞—Ç—å—Å—è –ø–æ –ø–∞–ª–∞—Ç–µ. –î–∞–Ω–Ω—ã–µ –ø–∏—à—É—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç—É –ø–∞–º—è—Ç–∏ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ Bluetooth LE.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤ –≠–≠–ì: 21',
                    '–ü–æ–ª–∏–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–∞–Ω–∞–ª—ã: 3 (–≠–ö–ì, –≠–ú–ì, –≠–û–ì)',
                    '–≠–∫—Å–ø–æ—Ä—Ç: EDF, CSV, Loreta',
                    '–°–≤—è–∑—å: –ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è (Blutooth LE) / –ó–∞–ø–∏—Å—å –Ω–∞ SD-–∫–∞—Ä—Ç—É',
                    '–ê–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å: –î–ª–∏—Ç–µ–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥',
                ]
            },

            // === CONSUMER (BrainBit / NeuroMD) ===
            brainbit: {
                id: 'brainbit',
                name: 'BrainBit Headband',
                category: 'con',
                icon: 'img/bb.png',
                short: '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π BrainBit',
                desc: '–ë–∞–∑–æ–≤—ã–π –Ω–µ–π—Ä–æ–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ B2B. –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–¥ –≤–µ—Ä—Å–∏–µ–π Black ‚Äî –æ—Ç–∫—Ä—ã—Ç—ã–π SDK –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å –ü–ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ (Kinesis, EEGWaves, BrainBit EEG).',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤: 4 (T3, T4, O1, O2)',
                    '–≠–ª–µ–∫—Ç—Ä–æ–¥—ã: –°—É—Ö–∏–µ',
                    'SDK: –û—Ç–∫—Ä—ã—Ç—ã–π (Free)',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –ë–û–°'
                ]
            },
            headband_pro: {
                id: 'headband_pro',
                name: 'BrainBit Headband Pro',
                category: 'con',
                icon: 'img/BBPRO.webp',
                short: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π BrainBit',
                desc: '–£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ BrainBit. –ò–º–µ–µ—Ç –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∫–∞—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∑–≥–∞.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤: 8 (Fp1, Fp2, T3/–°3, T4/C4, T5, T6, O1, O2)',
                    '–≠–ª–µ–∫—Ç—Ä–æ–¥—ã: –°—É—Ö–∏–µ',
                    'SDK: –û—Ç–∫—Ä—ã—Ç—ã–π',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ë–û–°, –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è'
                ]
            },
            mindo: {
                id: 'mindo',
                name: 'BrainBit Black / Mindo',
                category: 'con',
                icon: 'img/BBB.png',
                short: '–î–ª—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è',
                desc: '–°—Ç–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (B2C). Mindo ‚Äî –¥–ª—è –º–∏—Ä–∞, Black ‚Äî –¥–ª—è –†–§. –†–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ –º–æ–±–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤: 4',
                    '–≠–ª–µ–∫—Ç—Ä–æ–¥—ã: –°—É—Ö–∏–µ',
                    'SDK: ‚õî –ó–ê–ö–†–´–¢–´–ô',
                    '–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: –¢–æ–ª—å–∫–æ –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è'
                ]
            },

            // 2. –®–∞–ø–æ—á–∫–∏ –∏ –®–ª–µ–º—ã (Flex & Dragon)
            flex: {
                id: 'flex',
                name: 'BrainBit Flex',
                category: 'con',
                icon: 'img/Flex4.webp',
                short: '–ì–∏–±–∫–∞—è —à–∞–ø–æ—á–∫–∞',
                desc: '–°–∏—Å—Ç–µ–º–∞ —Å —Ñ–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä–æ–º —à–∞–ø–æ—á–∫–∏/—Å–µ—Ç–∫–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ —Ä–∞—Å—Å—Ç–∞–≤–ª—è—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–¥—ã —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ö–µ–º–µ 10-20 (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–µ–Ω—Ç).',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤: 4 (–°–º–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ)',
                    '–§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä: –¢–µ–∫—Å—Ç–∏–ª—å–Ω–∞—è —à–∞–ø–æ—á–∫–∞',
                    '–≠–ª–µ–∫—Ç—Ä–æ–¥—ã: –°—É—Ö–∏–µ/–ú–æ–∫—Ä—ã–µ',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –ù–µ–π—Ä–æ–º–∞—Ä–∫–µ—Ç–∏–Ω–≥'
                ]
            },
            flex8: {
                id: 'flex8',
                name: 'BrainBit Flex8',
                category: 'con',
                icon: 'img/Flex8.webp',
                short: '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π BrainBit Flex',
                desc: '–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è Flex —Å 8 –∫–∞–Ω–∞–ª–∞–º–∏.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤: 8 (–°–º–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ)',
                    '–§–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä: –¢–µ–∫—Å—Ç–∏–ª—å–Ω–∞—è —à–∞–ø–æ—á–∫–∞',
                    '–≠–ª–µ–∫—Ç—Ä–æ–¥—ã: –°—É—Ö–∏–µ/–ú–æ–∫—Ä—ã–µ',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –ù–µ–π—Ä–æ–º–∞—Ä–∫–µ—Ç–∏–Ω–≥'
                ]
            },
            dragoneeg: {
                id: 'dragoneeg',
                name: 'DragonEEG',
                category: 'con',
                icon: 'img/DragonEEG.webp',
                short: '–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≠–≠–ì',
                desc: '–ú–æ—â–Ω–µ–π—à–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞. –ü–æ–ª–Ω—ã–π –æ—Ö–≤–∞—Ç –≥–æ–ª–æ–≤—ã (–∫–∞–∫ –≤ –º–µ–¥–∏—Ü–∏–Ω–µ), –Ω–æ —Å —É–¥–æ–±—Å—Ç–≤–æ–º –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–π —Å–≤—è–∑–∏.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤: 21 (–ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ 10-20)',
                    '–≠–ª–µ–∫—Ç—Ä–æ–¥—ã: –°—É—Ö–∏–µ/–ú–æ–∫—Ä—ã–µ',
                    'SDK: –û—Ç–∫—Ä—ã—Ç—ã–π',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –°–µ—Ä—å–µ–∑–Ω–∞—è –Ω–∞—É–∫–∞, BCI'
                ]
            },

            // 3. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
            neurro: {
                id: 'neurro',
                name: '–°–∏—Å—Ç–µ–º–∞ Neurro',
                category: 'con',
                icon: 'img/neurro.png',
                short: '–ö–æ—Ä—Ä–µ–∫—Ü–∏—è –°–î–í–ì',
                desc: '–ì–æ—Ç–æ–≤—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ-–∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å –¥–ª—è –¥–µ—Ç–µ–π. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç BrainBit –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤–Ω–∏–º–∞–Ω–∏—è.',
                specs: [
                    '–ë–∞–∑–∞: BrainBit Flex, –Ω–æ —Å 2 –∫–∞–Ω–∞–ª–∞–º–∏',
                    '–ü–û: –ò–≥—Ä—ã –¥–ª—è Neurofeedback',
                    '–¶–µ–ª—å: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –°–î–í–ì –≤ –¥–æ–º–∞—à–Ω–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö',
                    '–ê—É–¥–∏—Ç–æ—Ä–∏—è: –î–µ—Ç–∏, –ü—Å–∏—Ö–æ–ª–æ–≥–∏, –†–æ–¥–∏—Ç–µ–ª–∏'
                ]
            },
            callibri: {
                id: 'callibri',
                name: 'Callibri (NeuroMD/BrainBit)',
                category: 'con',
                icon: 'img/Callibri.avif',
                short: '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –¥–∞—Ç—á–∏–∫',
                desc: '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –¥–∞—Ç—á–∏–∫. –ö—Ä–µ–ø–∏—Ç—Å—è –Ω–∞ –∫–ª–µ–π–∫–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã –Ω–∞ –ª—é–±—É—é –º—ã—à—Ü—É (–≠–ú–ì) –∏–ª–∏ —Ç–æ—á–∫—É –≥–æ–ª–æ–≤—ã (–≠–≠–ì). –°–∞–º—ã–π –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–∏–±–æ—Ä.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤: 1',
                    '–†–µ–∂–∏–º—ã: –≠–≠–ì / –≠–ú–ì / –≠–ö–ì / –î—ã—Ö–∞–Ω–∏–µ',
                    '–ö—Ä–µ–ø–ª–µ–Ω–∏–µ: –û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã/–°—É—Ö–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –§–∏—Ç–Ω–µ—Å, –†–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏—è, –ü—Ä–æ—Å—Ç–æ–π –ë–û–°'
                ]
            },
            headphones: {
                id: 'headphones',
                name: 'BrainBit Headphones',
                category: 'con',
                icon: 'img/HP.webp',
                short: '–ú—É–∑—ã–∫–∞ + –≠–≠–ì',
                desc: '–ü–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏ —Å–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —ç–ª–µ–∫—Ç—Ä–æ–¥–∞–º–∏ –≤ –∞–º–±—É—à—é—Ä–∞—Ö –∏ –¥—É–∂–∫–µ. –ü–æ–∑–≤–æ–ª—è—é—Ç –º–µ–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –º—É–∑—ã–∫—É —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é.',
                specs: [
                    '–ö–∞–Ω–∞–ª–æ–≤: 4',
                    '–§—É–Ω–∫—Ü–∏—è: Bluetooth Audio + EEG',
                    '–≠–ª–µ–∫—Ç—Ä–æ–¥—ã: –°—É—Ö–∏–µ',
                    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –†–µ–ª–∞–∫—Å–∞—Ü–∏—è, –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏'
                ]
            }
        };
    }

    // --- 4.1 –ò–ì–†–ê –°–û–†–¢–ò–†–û–í–ö–ê –†–´–ù–ö–û–í ---
    initMarketSorter() {
        const pool = this.container.querySelector('#sorter-tags');
        const bucketMed = this.container.querySelector('#bucket-med');
        const bucketCon = this.container.querySelector('#bucket-con');
        const feedback = this.container.querySelector('#sorter-feedback');

        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
        const items = [
            { text: "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —ç–ø–∏–ª–µ–ø—Å–∏–∏", type: "med" },
            { text: "–ú–µ–¥–∏—Ç–∞—Ü–∏—è –¥–æ–º–∞", type: "con" },
            { text: "–ì–µ–ª—å –∏ —à–∞–ø–æ—á–∫–∞", type: "med" },
            { text: "–ù–µ–π—Ä–æ–º–∞—Ä–∫–µ—Ç–∏–Ω–≥", type: "con" }, // –°–ø–æ—Ä–Ω–æ, –Ω–æ —á–∞—â–µ Consumer —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (Flex)
            { text: "–†–µ–≥. –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ (–†–£)", type: "med" },
            { text: "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–æ–Ω–æ–º", type: "con" },
            { text: "–ü–æ–∏—Å–∫ –æ–ø—É—Ö–æ–ª–∏", type: "med" },
            { text: "–§–∏—Ç–Ω–µ—Å –¥–ª—è –º–æ–∑–≥–∞", type: "con" }
        ];

        // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
        items.sort(() => Math.random() - 0.5);

        let selectedTag = null; // –¢–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç DOM

        // –†–µ–Ω–¥–µ—Ä —Ç–µ–≥–æ–≤
        items.forEach(item => {
            const tag = document.createElement('div');
            tag.className = 'sort-tag';
            tag.innerText = item.text;
            tag.dataset.type = item.type;

            tag.onclick = () => {
                // –ï—Å–ª–∏ —Ç–µ–≥ —É–∂–µ –≤ –≤–µ–¥—Ä–µ - –∏–≥–Ω–æ—Ä
                if (tag.classList.contains('correct')) return;

                // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö
                pool.querySelectorAll('.sort-tag').forEach(t => t.style.borderColor = '#ced4da');

                // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π
                tag.style.borderColor = '#0056b3';
                tag.style.background = '#e7f5ff';
                selectedTag = tag;
                feedback.innerText = "–ö—É–¥–∞ —ç—Ç–æ –æ—Ç–Ω–µ—Å—Ç–∏?";
                feedback.style.color = "#333";
            };
            pool.appendChild(tag);
        });

        // –õ–æ–≥–∏–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –≤–µ–¥—Ä–∞–º
        const checkAnswer = (targetType, bucketEl) => {
            if (!selectedTag) {
                feedback.innerText = "–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É!";
                feedback.style.color = "#e67e22";
                return;
            }

            const correctType = selectedTag.dataset.type;

            if (targetType === correctType) {
                // –í–ï–†–ù–û
                feedback.innerText = "–í–µ—Ä–Ω–æ!";
                feedback.style.color = "green";

                // –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–Ω–æ—Å–∞
                selectedTag.classList.add('correct');
                selectedTag.style.background = targetType === 'med' ? '#d1f2eb' : '#fcf3cf';
                selectedTag.style.borderColor = 'transparent';

                bucketEl.appendChild(selectedTag); // –ü–µ—Ä–µ–Ω–æ—Å –≤ DOM
                selectedTag = null;

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (pool.children.length === 0) {
                    feedback.innerText = "üéâ –û—Ç–ª–∏—á–Ω–æ! –í—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.";
                }
            } else {
                // –û–®–ò–ë–ö–ê
                feedback.innerText = "–û—à–∏–±–∫–∞! –ü–æ–¥—É–º–∞–π—Ç–µ –µ—â–µ —Ä–∞–∑.";
                feedback.style.color = "red";
                selectedTag.style.background = "#fadbd8";
                setTimeout(() => {
                    if (selectedTag) selectedTag.style.background = "#e7f5ff"; // –°–±—Ä–æ—Å —Ü–≤–µ—Ç–∞ –æ—à–∏–±–∫–∏
                }, 500);
            }
        };

        bucketMed.onclick = () => checkAnswer('med', bucketMed);
        bucketCon.onclick = () => checkAnswer('con', bucketCon);
    }

    // --- 4.2 –∏ 4.3 –ì–ê–õ–ï–†–ï–Ø ---
    initGallery(filterType) {
        const grid = this.container.querySelector(filterType === 'med' ? '#med-grid' : '#con-grid');
        const detailView = this.container.querySelector(filterType === 'med' ? '#med-detail' : '#con-detail');
        const title = this.container.querySelector(filterType === 'med' ? '#med-title' : '#con-title');
        const desc = this.container.querySelector(filterType === 'med' ? '#med-desc' : '#con-desc');
        const specs = this.container.querySelector(filterType === 'med' ? '#med-specs' : '#con-specs');

        const db = this.getDevices();

        // –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–µ–∫
        Object.values(db).forEach(device => {
            if (device.category !== filterType) return;

            const card = document.createElement('div');
            card.className = 'product-card';

            // –ë–µ–π–¥–∂
            const badgeClass = filterType === 'med' ? 'med' : 'con';
            const badgeText = filterType === 'med' ? 'Medical' : 'Consumer';

            card.innerHTML = `
                <div class="badge ${badgeClass}">${badgeText}</div>
                <div class="device-mockup">
                    <img src="${device.icon}" alt="${device.name}">
                </div>
                <div class="prod-title">${device.name}</div>
                <div class="prod-desc">${device.short}</div>
            `;

            card.onclick = () => {
                // –°–±—Ä–æ—Å –≤—ã–¥–µ–ª–µ–Ω–∏—è
                grid.querySelectorAll('.product-card').forEach(c => c.classList.remove('selected'));
                card.classList.add('selected');

                // –ü–æ–∫–∞–∑ –¥–µ—Ç–∞–ª–µ–π
                detailView.style.display = 'block';
                title.innerText = device.name;
                desc.innerText = device.desc;
                specs.innerHTML = device.specs.map(s => {
                    const [k, v] = s.split(':');
                    return `<li><b>${k}:</b>${v}</li>`;
                }).join('');
            };

            grid.appendChild(card);
        });
    }

// --- 4.4 –ü–†–û–î–í–ò–ù–£–¢–´–ô –°–ò–ú–£–õ–Ø–¢–û–† –ü–†–û–î–ê–ñ ---
    initSalesSim() {
        const root = this.container.querySelector('#sales-engine-root');

        // –ë–∞–∑–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
        const scenarios = [
            {
                client: {
                    name: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤–∏—á",
                    role: "–ì–ª–∞–≤–≤—Ä–∞—á —á–∞—Å—Ç–Ω–æ–π –∫–ª–∏–Ω–∏–∫–∏",
                    avatar: "üë®‚Äç‚öïÔ∏è",
                    tags: ["–ú–µ–¥–∏—Ü–∏–Ω–∞", "–õ–∏—Ü–µ–Ω–∑–∏—è", "–ë—é–¥–∂–µ—Ç: –°—Ä–µ–¥–Ω–∏–π"],
                    reqs: "–ù–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –≠–≠–ì –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å–ø—Ä–∞–≤–æ–∫ –∏ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –ø—Ä–∏–µ–º–∞. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ª–∏—á–∏–µ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è (–†–£). –í—Ä–∞—á–∏ –ø—Ä–∏–≤—ã–∫–ª–∏ –∫ –≥–µ–ª—é."
                },
                options: ['brainbit', 'kompakt16', 'neurro', 'callibri'],
                correctId: 'kompakt16',
                // –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä
                feedback: {
                    brainbit: "–ö–ª–∏–Ω–∏–∫–∞ –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BrainBit. –£ –Ω–µ–≥–æ –Ω–µ—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –†–£. –≠—Ç–æ –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.",
                    neurro: "Neurro ‚Äî —ç—Ç–æ –¥–µ—Ç—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂–µ—Ä, –∞ –Ω–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–±–æ—Ä. –í—Ä–∞—á—É –æ–Ω –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω.",
                    callibri: "Callibri ‚Äî —ç—Ç–æ 1 –∫–∞–Ω–∞–ª. –î–ª—è —Å–ø—Ä–∞–≤–∫–∏ –ì–ò–ë–î–î –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 16-19 –∫–∞–Ω–∞–ª–æ–≤."
                },
                successMsg: "–û—Ç–ª–∏—á–Ω–æ! ¬´–ö–æ–º–ø–∞–∫—Ç-–Ω–µ–π—Ä–æ 16¬ª ‚Äî –∏–¥–µ–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞. –ï—Å—Ç—å –†–£, –Ω–∞–¥–µ–∂–Ω—ã–π –≥–µ–ª—å, –Ω–∏–∑–∫–∞—è —Ü–µ–Ω–∞."
            },
            {
                client: {
                    name: "–ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞",
                    role: "–î–µ—Ç—Å–∫–∏–π –Ω–µ–π—Ä–æ–ø—Å–∏—Ö–æ–ª–æ–≥",
                    avatar: "üë©‚Äçüè´",
                    tags: ["–°–î–í–ì", "–î–µ—Ç–∏", "–ö–æ—Ä—Ä–µ–∫—Ü–∏—è"],
                    reqs: "–Ø —Ä–∞–±–æ—Ç–∞—é —Å –≥–∏–ø–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–µ—Ç—å–º–∏ (–°–î–í–ì). –ú–Ω–µ –Ω—É–∂–Ω–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏—Ö —É—Å–∏–¥—á–∏–≤–æ—Å—Ç—å (–ë–û–°). –î–µ—Ç–∏ –Ω–µ –ª—é–±—è—Ç —à–∞–ø–æ—á–∫–∏ —Å –≥–µ–ª–µ–º, –Ω—É–∂–Ω–æ —á—Ç–æ-—Ç–æ –≤–µ—Å–µ–ª–æ–µ –∏ —Å—É—Ö–æ–µ."
                },
                options: ['kompakt21', 'brainbit', 'neurro', 'polygraph'],
                correctId: 'neurro', // –ò–ª–∏ BrainBit, –Ω–æ Neurro –ª—É—á—à–µ —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –≥–æ—Ç–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å
                feedback: {
                    kompakt21: "–ì–µ–ª–µ–≤—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã –∏ –ø—Ä–æ–≤–æ–¥–∞ –ø—É–≥–∞—é—Ç –¥–µ—Ç–µ–π. –ù–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É —É–π–¥–µ—Ç –≤—Å–µ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–∏—è.",
                    brainbit: "BrainBit –ø–æ–¥—Ö–æ–¥–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏, –Ω–æ ¬´–°–∏—Å—Ç–µ–º–∞ Neurro¬ª –ª—É—á—à–µ, —Ç–∞–∫ –∫–∞–∫ –≤–∫–ª—é—á–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –¥–µ—Ç—Å–∫–∏–π —Å–æ—Ñ—Ç.",
                    polygraph: "–≠—Ç–æ –æ–≥—Ä–æ–º–Ω–∞—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–∞—è –º–∞—à–∏–Ω–∞. –ò–∑–±—ã—Ç–æ—á–Ω–æ –∏ –¥–æ—Ä–æ–≥–æ –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∞."
                },
                successMsg: "–í–µ—Ä–Ω–æ! –°–∏—Å—Ç–µ–º–∞ Neurro —Å–æ–∑–¥–∞–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –°–î–í–ì. –°—É—Ö–æ–π –∫–æ–Ω—Ç–∞–∫—Ç –∏ –∏–≥—Ä–æ–≤—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–±–µ–Ω–∫—É."
            },
            {
                client: {
                    name: "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è UX/UI",
                    role: "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ –ù–µ–π—Ä–æ–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞",
                    avatar: "üïµÔ∏è‚Äç‚ôÇÔ∏è",
                    tags: ["Research", "–°–≤–æ–±–æ–¥–∞", "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"],
                    reqs: "–ú—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º —Ä–µ–∞–∫—Ü–∏—é –ª—é–¥–µ–π –Ω–∞ –¥–∏–∑–∞–π–Ω —Å–∞–π—Ç–æ–≤. –ù–∞–º –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è—Ç—å –ª—é–¥–µ–π (–ø–æ—Ç–æ–∫). –í–∞–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–¥—ã –Ω–∞ –ª–æ–±–Ω—É—é –¥–æ–ª—é (Fp1, Fp2) –∏ –∑–∞—Ç—ã–ª–æ–∫ (O1, O2)."
                },
                options: ['brainbit', 'flex', 'kompakt16'],
                correctId: 'flex',
                feedback: {
                    brainbit: "–û–±—ã—á–Ω—ã–π BrainBit –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã –Ω–∞ –≤–∏—Å–∫–∞—Ö. –û–Ω –Ω–µ –¥–æ—Å—Ç–∞–Ω–µ—Ç –¥–æ –ª–±–∞ (Fp1/Fp2), –≥–¥–µ –∂–∏–≤—É—Ç —ç–º–æ—Ü–∏–∏.",
                    kompakt16: "–°–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –º—ã—Ç—å –≥–æ–ª–æ–≤—É –∫–∞–∂–¥–æ–º—É —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—É. –î–ª—è –ø–æ—Ç–æ–∫–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ –Ω—É–∂–Ω–æ —Å—É—Ö–æ–µ —Ä–µ—à–µ–Ω–∏–µ."
                },
                successMsg: "–í —Ç–æ—á–∫—É! BrainBit Flex –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–¥–≤–∏–Ω—É—Ç—å —Å—É—Ö–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã –Ω–∞ –ª—é–±—ã–µ –∑–æ–Ω—ã, –≤–∫–ª—é—á–∞—è –ª–æ–±, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞."
            },
            {
                client: {
                    name: "–¶–µ–Ω—Ç—Ä –°–æ–º–Ω–æ–ª–æ–≥–∏–∏",
                    role: "–ó–∞–≤. –æ—Ç–¥–µ–ª–µ–Ω–∏–µ–º",
                    avatar: "üò¥",
                    tags: ["–°–æ–Ω", "–°—Ç–∞—Ü–∏–æ–Ω–∞—Ä", "–ù–∞—É–∫–∞"],
                    reqs: "–ú—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä—É–µ–º –∞–ø–Ω–æ—ç –∏ —Å–ª–æ–∂–Ω—ã–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–Ω–∞. –ü–∏—à–µ–º –ø–∞—Ü–∏–µ–Ω—Ç–∞ –≤—Å—é –Ω–æ—á—å. –ù—É–∂–Ω—ã –∫–∞–Ω–∞–ª—ã –≠–ö–ì, –≠–û–ì, –≠–ú–ì."
                },
                options: ['neuroeeg', 'brainbit', 'kompakt16', 'neuropoly'],
                correctId: 'neuropoly', // –ò–ª–∏ NeuroEEG, –Ω–æ –ü–æ–ª–∏–≥—Ä–∞—Ñ –∫–ª–∞—Å—Å–∏–∫–∞
                feedback: {
                    brainbit: "–°—É—Ö–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã –Ω–µ –≤—ã–¥–µ—Ä–∂–∞—Ç 8 —á–∞—Å–æ–≤ —Å–Ω–∞ (—Å–ø–æ–ª–∑—É—Ç, –±—É–¥—É—Ç –¥–∞–≤–∏—Ç—å). –ò –º–∞–ª–æ –∫–∞–Ω–∞–ª–æ–≤.",
                    kompakt16: "–ú–∞–ª–æ –ø–æ–ª–∏–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤. –î–ª—è —Å–Ω–∞ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞—Ç—á–∏–∫–æ–≤.",
                    neuroeeg: "–¢–æ–∂–µ —Ö–æ—Ä–æ—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç (–º–æ–±–∏–ª—å–Ω—ã–π), –Ω–æ –ù–µ–π—Ä–æ–ø–æ–ª–∏–≥—Ä–∞—Ñ ‚Äî –∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ —Å–Ω–∞."
                },
                successMsg: "–ü—Ä–∞–≤–∏–ª—å–Ω–æ. –ù–µ–π—Ä–æ–ø–æ–ª–∏–≥—Ä–∞—Ñ –∏–º–µ–µ—Ç –ø–æ–ª–∏–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–∞–Ω–∞–ª—ã –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–∏ –Ω–∞ –≤—Å—é –Ω–æ—á—å. –í–∞–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—é —Å –≤–∏–¥–µ–æ–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º"
            }
        ];

        let currentIdx = 0;
        const db = this.getDevices();

        // –§—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞
        const renderStep = () => {
            // –û—á–∏—Å—Ç–∫–∞
            root.innerHTML = '';

            // –§–∏–Ω–∏—à
            if (currentIdx >= scenarios.length) {
                root.innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <div style="font-size: 60px;">üèÜ</div>
                        <h3>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h3>
                        <p>–í—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–∫—Ä—ã–ª–∏ –≤—Å–µ —Å–¥–µ–ª–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞–ª–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ.</p>
                    </div>
                `;
                return;
            }

            const scen = scenarios[currentIdx];

            // 1. –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞
            const card = document.createElement('div');
            card.className = 'client-card fade-in';
            card.innerHTML = `
                <div class="client-avatar">${scen.client.avatar}</div>
                <div class="client-info">
                    <div class="client-name">${scen.client.name}</div>
                    <div style="color: #666; font-size: 13px; margin-bottom: 8px;">${scen.client.role}</div>
                    <div class="client-tags">
                        ${scen.client.tags.map(t => `<span class="client-tag">${t}</span>`).join('')}
                    </div>
                    <div class="client-reqs">
                        <b>–ó–∞–ø—Ä–æ—Å:</b> "${scen.client.reqs}"
                    </div>
                </div>
            `;
            root.appendChild(card);

            // 2. –ó–æ–Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (—Å–∫—Ä—ã—Ç–∞)
            const resultDiv = document.createElement('div');
            resultDiv.className = 'sales-result';
            root.appendChild(resultDiv);

            // 3. –ö–Ω–æ–ø–∫–∞ "–î–∞–ª–µ–µ" (—Å–∫—Ä—ã—Ç–∞)
            const nextBtn = document.createElement('button');
            nextBtn.className = 'next-scenario-btn';
            nextBtn.innerText = "–°–ª–µ–¥—É—é—â–∏–π –∫–ª–∏–µ–Ω—Ç ‚Üí";
            nextBtn.onclick = () => {
                currentIdx++;
                renderStep();
            };
            root.appendChild(nextBtn);

            // 4. –û–ø—Ü–∏–∏ –≤—ã–±–æ—Ä–∞
            const grid = document.createElement('div');
            grid.className = 'sales-options';

            scen.options.forEach(devId => {
                const device = db[devId];
                if (!device) return; // –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–ø–µ—á–∞—Ç–æ–∫

                const btn = document.createElement('div');
                btn.className = 'product-card';
                btn.innerHTML = `
                    <div class="device-mockup small">
                        <img src="${device.icon}" alt="${device.name}" style="max-height: 100%;">
                    </div>
                    <div class="prod-title" style="font-size: 12px; text-align: center;">${device.name}</div>
                `;

                btn.onclick = () => {
                    // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∫–ª–∏–∫–∏, –µ—Å–ª–∏ —É–∂–µ —É–≥–∞–¥–∞–ª–∏
                    if (resultDiv.classList.contains('success')) return;

                    if (devId === scen.correctId) {
                        // –£–°–ü–ï–•
                        resultDiv.className = 'sales-result success';
                        resultDiv.innerHTML = `<b>‚úÖ –ü—Ä–æ–¥–∞–Ω–æ!</b> ${scen.successMsg}`;
                        resultDiv.style.display = 'block';
                        nextBtn.style.display = 'block';

                        // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏
                        btn.style.borderColor = 'green';
                        btn.style.background = '#e6fffa';
                    } else {
                        // –û–®–ò–ë–ö–ê - –∏—â–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π —Ñ–∏–¥–±–µ–∫
                        const specificFeedback = scen.feedback[devId] || "–≠—Ç–æ—Ç –ø—Ä–∏–±–æ—Ä –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞.";

                        resultDiv.className = 'sales-result failure';
                        resultDiv.innerHTML = `<b>‚ùå –û—Ç–∫–∞–∑.</b> ${specificFeedback}`;
                        resultDiv.style.display = 'block';

                        // –ê–Ω–∏–º–∞—Ü–∏—è –æ—à–∏–±–∫–∏
                        btn.style.borderColor = 'red';
                        setTimeout(() => btn.style.borderColor = '#dee2e6', 500);
                    }
                };
                grid.appendChild(btn);
            });

            // –í—Å—Ç–∞–≤–ª—è–µ–º —Å–µ—Ç–∫—É –ø–µ—Ä–µ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º (–≤–∏–∑—É–∞–ª—å–Ω–æ –ª—É—á—à–µ)
            root.insertBefore(grid, resultDiv);
        };

        renderStep();
    }

    // --- 4.5 –°–õ–û–ñ–ù–´–ô –ü–†–û–î–£–ö–¢–û–í–´–ô –ö–í–ò–ó ---
    initQuiz() {
        const container = this.container.querySelector('#quiz-container');
        if(!container) return;

        const questions = [
            {
                text: "–°—Ç–∞—Ä—Ç–∞–ø —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –º–µ–¥–∏—Ç–∞—Ü–∏–∏ –∏ —Ö–æ—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–¥ —Å–≤–æ–∏–º –±—Ä–µ–Ω–¥–æ–º. –û–Ω–∏ –∑–∞–∫—É–ø–∏–ª–∏ –ø–∞—Ä—Ç–∏—é BrainBit Black (Mindo) –∏–∑-–∑–∞ –∫—Ä–∞—Å–∏–≤–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞. –í —á–µ–º —Ñ–∞—Ç–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞?",
                options: [
                    { text: "–£ –≤–µ—Ä—Å–∏–∏ Black/Mindo –∑–∞–∫—Ä—ã—Ç—ã–π SDK. –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–µ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å —Å –Ω–µ–≥–æ —Å—ã—Ä–æ–π —Å–∏–≥–Ω–∞–ª.", correct: true },
                    { text: "–£ –≤–µ—Ä—Å–∏–∏ Black –º–µ–Ω—å—à–µ –∫–∞–Ω–∞–ª–æ–≤, —á–µ–º —É –æ–±—ã—á–Ω–æ–≥–æ BrainBit.", correct: false },
                    { text: "–í–µ—Ä—Å–∏—è Black —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ USB, –∞ –∏–º –Ω—É–∂–µ–Ω Bluetooth.", correct: false },
                    { text: "–ù–∏–∫–∞–∫–æ–π –æ—à–∏–±–∫–∏ –Ω–µ—Ç, —ç—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä.", correct: false }
                ],
                explanation: "–í–µ—Ä—Å–∏–∏ Black/Mindo –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (B2C) –∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å —Ä–æ–¥–Ω—ã–º–∏ –º–æ–±–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏. –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (B2B) –ø–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π BrainBit —Å –æ—Ç–∫—Ä—ã—Ç—ã–º SDK."
            },
            {
                text: "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –∏–∑—É—á–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ü—Ä–µ—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–æ—Ä—ã (–õ–æ–±–Ω—ã–µ –¥–æ–ª–∏ - Fp1, Fp2), –æ—Ç–≤–µ—á–∞—é—â–µ–π –∑–∞ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π. –ü–æ—á–µ–º—É –µ–º—É –ù–ï –ø–æ–¥–æ–π–¥–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–±–æ–¥–æ–∫ BrainBit Headband?",
                options: [
                    { text: "–£  BrainBit —ç–ª–µ–∫—Ç—Ä–æ–¥—ã —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ –≤–∏—Å–∫–∞—Ö (T3/T4) –∏ –∑–∞—Ç—ã–ª–∫–µ (O1/O2). –û–Ω —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ –¥–æ—Å—Ç–∞–µ—Ç –¥–æ –ª–±–∞.", correct: true },
                    { text: "–£ BrainBit —Å—É—Ö–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã, –∞ –¥–ª—è –ª–±–∞ –Ω—É–∂–Ω—ã –º–æ–∫—Ä—ã–µ.", correct: false },
                    { text: "–£ BrainBit –≤—Å–µ–≥–æ 4 –∫–∞–Ω–∞–ª–∞, –∞ –¥–ª—è –ª–±–∞ –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 8.", correct: false }
                ],
                explanation: "–≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ñ–æ—Ä–º-—Ñ–∞–∫—Ç–æ—Ä–∞. –ñ–µ—Å—Ç–∫–∏–π –æ–±–æ–¥–æ–∫ –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏. –î–ª—è –ª–æ–±–Ω—ã—Ö –¥–æ–ª–µ–π –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BrainBit Flex (–ª–µ–Ω—Ç—É) –∏–ª–∏ —à–ª–µ–º DragonEEG."
            },
            {
                text: "–ß–∞—Å—Ç–Ω–∞—è –∫–ª–∏–Ω–∏–∫–∞ —Ö–æ—á–µ—Ç –∫—É–ø–∏—Ç—å —à–ª–µ–º DragonEEG (21 –∫–∞–Ω–∞–ª) –¥–ª—è —Ä—É—Ç–∏–Ω–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —ç–ø–∏–ª–µ–ø—Å–∏–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –≤—ã–≥–ª—è–¥–∏—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–µ–µ –∏ —É–¥–æ–±–Ω–µ–µ, —á–µ–º ¬´–ö–æ–º–ø–∞–∫—Ç-–Ω–µ–π—Ä–æ¬ª. –ú–æ–∂–µ–º –ª–∏ –º—ã –ø—Ä–æ–¥–∞—Ç—å –∏–º –µ–≥–æ –¥–ª—è —ç—Ç–∏—Ö —Ü–µ–ª–µ–π?",
                options: [
                    { text: "–î–∞, –≤–µ–¥—å —É –Ω–µ–≥–æ —Ç–æ–∂–µ 21 –∫–∞–Ω–∞–ª, –∫–∞–∫ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ 10-20.", correct: false },
                    { text: "–ù–µ—Ç. DragonEEG ‚Äî —ç—Ç–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–∏–±–æ—Ä –±–µ–∑ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è (–†–£). –í—Ä–∞—á –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ —Å—Ç–∞–≤–∏—Ç—å –¥–∏–∞–≥–Ω–æ–∑ –Ω–∞ –µ–≥–æ –æ—Å–Ω–æ–≤–µ.", correct: true },
                    { text: "–î–∞, –Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∫—Ä—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã.", correct: false }
                ],
                explanation: "–ù–∞–ª–∏—á–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –Ω–µ –¥–µ–ª–∞–µ—Ç –ø—Ä–∏–±–æ—Ä –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º. –î–ª—è –∫–ª–∏–Ω–∏–∫–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –Ω–∞–ª–∏—á–∏–µ –†–£ –ú–∏–Ω–∑–¥—Ä–∞–≤–∞. DragonEEG ‚Äî —ç—Ç–æ –Ω–∞—É—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (Research), –∞ –Ω–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø—Ä–æ–¥—É–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω–æ–º —Ä—ã–Ω–∫–µ."
            },
            {
                text: "–í —á–µ–º –∫–ª—é—á–µ–≤–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ—Ç–ª–∏—á–∏–µ ¬´–ù–µ–π—Ä–æ–ø–æ–ª–∏–≥—Ä–∞—Ñ–∞¬ª –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ ¬´–ö–æ–º–ø–∞–∫—Ç-–Ω–µ–π—Ä–æ 21¬ª, –ø–æ–º–∏–º–æ –Ω–∞–∑–≤–∞–Ω–∏—è?",
                options: [
                    { text: "–£ –ù–µ–π—Ä–æ–ø–æ–ª–∏–≥—Ä–∞—Ñ–∞ –µ—Å—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –≤—Ö–æ–¥—ã –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ–¥–æ–≤ –≠–ö–ì, –≠–ú–ì –∏ –≠–û–ì.", correct: true },
                    { text: "–£ –ù–µ–π—Ä–æ–ø–æ–ª–∏–≥—Ä–∞—Ñ–∞ —Å—É—Ö–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã.", correct: false },
                    { text: "–ù–µ–π—Ä–æ–ø–æ–ª–∏–≥—Ä–∞—Ñ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ Bluetooth, –∞ –ö–æ–º–ø–∞–∫—Ç-–ù–µ–π—Ä–æ –ø–æ USB.", correct: false },
                    { text: "–†–∞–∑–Ω–∏—Ü—ã –Ω–µ—Ç, —ç—Ç–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ.", correct: false }
                ],
                explanation: "–ü—Ä–∏—Å—Ç–∞–≤–∫–∞ ¬´–ü–æ–ª–∏-¬ª –æ–∑–Ω–∞—á–∞–µ—Ç –º–Ω–æ–≥–æ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π. –£ —ç—Ç–æ–≥–æ –ø—Ä–∏–±–æ—Ä–∞ –µ—Å—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —É—Å–∏–ª–∏—Ç–µ–ª–∏ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–µ—Ä–¥—Ü–∞, –º—ã—à—Ü –∏ –¥–≤–∏–∂–µ–Ω–∏–π –≥–ª–∞–∑ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –≠–≠–ì."
            },
            {
                text: "–ö–ª–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç –º–µ–∂–¥—É Callibri –∏ BrainBit –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏—è (–ê–ª—å—Ñ–∞-—Ç—Ä–µ–Ω–∏–Ω–≥). –ü–æ—á–µ–º—É BrainBit –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ, —Ö–æ—Ç—è Callibri –¥–µ—à–µ–≤–ª–µ?",
                options: [
                    { text: "BrainBit –∏–º–µ–µ—Ç 4 –∫–∞–Ω–∞–ª–∞, —á—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ë–û–°. Callibri ‚Äî —ç—Ç–æ –≤—Å–µ–≥–æ 1 –∫–∞–Ω–∞–ª.", correct: true },
                    { text: "Callibri –Ω–µ —É–º–µ–µ—Ç –ø–∏—Å–∞—Ç—å –≠–≠–ì, —Ç–æ–ª—å–∫–æ –º—ã—à—Ü—ã.", correct: false },
                    { text: "BrainBit —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ–ª—å—à–µ –æ—Ç –±–∞—Ç–∞—Ä–µ–∏.", correct: false }
                ],
                explanation: "–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –Ω–µ–π—Ä–æ—Ñ–∏–¥–±–µ–∫–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ 1 –∫–∞–Ω–∞–ª–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≠–≠–ì. –û–¥–∏–Ω –∫–∞–Ω–∞–ª Callibri –¥–∞–µ—Ç —Å–ª–∏—à–∫–æ–º ¬´–ø–ª–æ—Å–∫—É—é¬ª –∫–∞—Ä—Ç–∏–Ω—É."
            }
        ];

        let answeredCount = 0;
        const total = questions.length;

        questions.forEach((q, idx) => {
            const el = document.createElement('div');
            el.className = 'quiz-question';
            el.dataset.answered = "false";

            el.innerHTML = `<div style="font-size:10px; color:#888; margin-bottom:5px;">–í–û–ü–†–û–° ${idx+1}</div><h3>${q.text}</h3>`;

            const opts = document.createElement('div');
            opts.className = 'quiz-options';

            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ
            const shuffledOptions = [...q.options].sort(() => Math.random() - 0.5);

            shuffledOptions.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'quiz-btn';
                btn.innerText = opt.text;

                btn.onclick = () => {
                    if(el.dataset.answered === "true") return;
                    el.dataset.answered = "true";

                    if(opt.correct) {
                        btn.classList.add('correct');
                        const expl = document.createElement('div');
                        expl.className = 'quiz-explanation';
                        expl.style.display = 'block';
                        expl.innerHTML = `<b>–í–µ—Ä–Ω–æ!</b> ${q.explanation}`;
                        el.appendChild(expl);
                    } else {
                        btn.classList.add('wrong');
                        const expl = document.createElement('div');
                        expl.className = 'quiz-explanation';
                        expl.style.display = 'block';
                        expl.style.background = '#fff3cd';
                        expl.style.color = '#856404';
                        expl.innerHTML = `<b>–û—à–∏–±–∫–∞.</b> ${q.explanation}`;
                        el.appendChild(expl);
                    }
                };
                opts.appendChild(btn);
            });
            el.appendChild(opts);
            container.appendChild(el);
        });
    }
}